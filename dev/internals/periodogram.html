
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>periodogram &#8212; UTide 0.2.6.dev10+g93cdb9e documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="robustfit" href="robustfit.html" />
    <link rel="prev" title="Internal details" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="robustfit.html" title="robustfit"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Internal details"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">UTide 0.2.6.dev10+g93cdb9e documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Internal details</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="periodogram">
<h1>periodogram<a class="headerlink" href="#periodogram" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-utide.periodogram">
<span id="utide-periodogram"></span><h2><a class="reference internal" href="#module-utide.periodogram" title="utide.periodogram"><code class="xref py py-mod docutils literal notranslate"><span class="pre">utide.periodogram</span></code></a><a class="headerlink" href="#module-utide.periodogram" title="Permalink to this headline">¶</a></h2>
<p>Band-averaged spectral estimation for use in tidal error analysis.</p>
<p>There is only one function in this module that is imported by
other modules: <a class="reference internal" href="#utide.periodogram.band_psd" title="utide.periodogram.band_psd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">band_psd</span></code></a> (<code class="docutils literal notranslate"><span class="pre">ut_pdgm</span></code> in the Matlab version), which
uses the residuals from the tidal fit to calculate power spectral
density averaged in bands near the constituent clusters.</p>
<p>Because the functions here are intended for internal use only,
they are stripped down to their essentials, with little or
no argument checking.  Some argument flexibility is included
to facilitate testing.</p>
<dl class="py function">
<dt id="utide.periodogram._lomb_freqs">
<code class="sig-prename descclassname">utide.periodogram.</code><code class="sig-name descname">_lomb_freqs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">fbands</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ofac</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_per_band</span><span class="o">=</span><span class="default_value">500</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/utide/periodogram.html#_lomb_freqs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utide.periodogram._lomb_freqs" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate uniformly spaced frequencies in each band, with
no more than <code class="xref py py-obj docutils literal notranslate"><span class="pre">max_per_band</span></code> in any band.</p>
</dd></dl>

<dl class="py function">
<dt id="utide.periodogram._ls_cross">
<code class="sig-prename descclassname">utide.periodogram.</code><code class="sig-name descname">_ls_cross</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">fr</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/utide/periodogram.html#_ls_cross"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utide.periodogram._ls_cross" title="Permalink to this definition">¶</a></dt>
<dd><p>Cross spectral counterpart of signal.lombscargle.</p>
</dd></dl>

<dl class="py function">
<dt id="utide.periodogram._psd">
<code class="sig-prename descclassname">utide.periodogram.</code><code class="sig-name descname">_psd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span></em>, <em class="sig-param"><span class="n">window</span></em>, <em class="sig-param"><span class="n">fs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/utide/periodogram.html#_psd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utide.periodogram._psd" title="Permalink to this definition">¶</a></dt>
<dd><p>Autospectrum if <code class="xref py py-obj docutils literal notranslate"><span class="pre">e</span></code> is real, or cross spectrum if complex.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">e</span></code> must be uniformly spaced, with sampling frequency <code class="xref py py-obj docutils literal notranslate"><span class="pre">fs</span></code> in
cycles per time unit.  Number of points is assumed to be even.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">window</span></code> is a set of data windowing weights, the length of <code class="xref py py-obj docutils literal notranslate"><span class="pre">e</span></code></p>
<p>Returns PSD in cycles per time unit.</p>
</dd></dl>

<dl class="py function">
<dt id="utide.periodogram._psd_lomb">
<code class="sig-prename descclassname">utide.periodogram.</code><code class="sig-name descname">_psd_lomb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">freq</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ofac</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/utide/periodogram.html#_psd_lomb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utide.periodogram._psd_lomb" title="Permalink to this definition">¶</a></dt>
<dd><p>Periodogram estimate for irregular sampling, Lomb-Scargle method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>ndarray</em><em>, </em><em>(</em><em>n</em><em>,</em><em>)</em>) – time, monotonic but possibly irregularly spaced</p></li>
<li><p><strong>x</strong> (<em>ndarray</em><em>, </em><em>(</em><em>n</em><em>,</em><em>)</em>) – signal, real or complex</p></li>
<li><p><strong>window</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a><em> or </em><em>ndarray</em><em>, </em><em>(</em><em>n</em><em>,</em><em>)</em>) – if not None, a uniformly-sampled data window</p></li>
<li><p><strong>freq</strong> (<em>ndarray</em><em> (</em><em>nfreq</em><em>,</em><em>)</em>) – evaluation frequencies in cycles per unit time</p></li>
<li><p><strong>ofac</strong> (<em>integer</em>) – oversampling factor; defaults to 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>P</strong> –</p>
<ul class="simple">
<li><p>P.F: Frequencies (units: cycles per time unit) of the Pxx estimates.</p></li>
<li><p>P.Pxx: One-sided auto-spectral density estimate for real(<code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code>).</p></li>
</ul>
<p>if <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> is complex:</p>
<ul class="simple">
<li><p>P.Pyy: as above, for imag(<code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code>)</p></li>
<li><p>P.Pxy: complex cross-spectrum between real(<code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code>) and imag(<code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code>)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Bunch</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">freq</span></code> is None, <code class="xref py py-obj docutils literal notranslate"><span class="pre">P.F</span></code> is calculated to coincide with the
Fourier frequencies for a series of n uniformly distributed
times from min(<code class="xref py py-obj docutils literal notranslate"><span class="pre">t</span></code>) to max(<code class="xref py py-obj docutils literal notranslate"><span class="pre">t</span></code>). The mean and Nyquist are omitted
because they are irrelevant in this context.</p>
<p>PSD units are [<code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code>-units^2 per cycle per unit time]</p>
</dd></dl>

<dl class="py function">
<dt id="utide.periodogram.band_psd">
<code class="sig-prename descclassname">utide.periodogram.</code><code class="sig-name descname">band_psd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">e</span></em>, <em class="sig-param"><span class="n">cfrq</span></em>, <em class="sig-param"><span class="n">equi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">frqosamp</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/utide/periodogram.html#band_psd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utide.periodogram.band_psd" title="Permalink to this definition">¶</a></dt>
<dd><p>Band-averaged power spectral density in vicinity of tidal constituents</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>ndarray</em>) – time [days] relative to an arbitrary origin</p></li>
<li><p><strong>e</strong> (<em>ndarray</em>) – residual from tidal fit, complex/real</p></li>
<li><p><strong>cfrq</strong> (<em>ndarray</em>) – frequencies of NR &amp; R constituents [CPH]</p></li>
<li><p><strong>equi</strong> (<em>boolean</em>) – True (default) if sample times are uniformly spaced</p></li>
<li><p><strong>frqosamp</strong> (<em>integer</em>) – Lomb-Scargle frequency oversampling factor, if equi = False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>P</strong> –</p>
<ul class="simple">
<li><p>P.fbnd : edges of freq bands [CPH]</p></li>
<li><p>P.Puu : 1-sided auto-sp dens of u err (=real(e)) [units^2/CPH]</p></li>
<li><p>P.Pvv : (complex case only)= as P.Puu but for v err (=imag(e))</p></li>
<li><p>P.Puv (complex case only)= cross-sp dens between u and v</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Bunch</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the only function in this module that is called from
other modules.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="utide.periodogram.fbndavg">
<code class="sig-prename descclassname">utide.periodogram.</code><code class="sig-name descname">fbndavg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">P</span></em>, <em class="sig-param"><span class="n">freq</span></em>, <em class="sig-param"><span class="n">cfreq</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fbands</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/utide/periodogram.html#fbndavg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utide.periodogram.fbndavg" title="Permalink to this definition">¶</a></dt>
<dd><p>Band-average periodogram, excluding constituent frequencies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>ndarray</em><em> (</em><em>nfreq</em><em>,</em><em>)</em>) – periodogram in units^2 per CPH</p></li>
<li><p><strong>freq</strong> (<em>ndarray</em><em> (</em><em>nfreq</em><em>,</em><em>)</em>) – frequencies in CPH</p></li>
<li><p><strong>cfreq</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a><em> or </em><em>array_like</em>) – constituent frequencies (CPH) to be excluded</p></li>
<li><p><strong>fbands</strong> (<em>array_like</em><em> (</em><em>nbands</em><em>, </em><em>2</em><em>)</em>) – limits of frequency bands; defaults to 9 bands in <code class="xref py py-obj docutils literal notranslate"><span class="pre">freq_bands</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean of <code class="xref py py-obj docutils literal notranslate"><span class="pre">P</span></code> within <code class="xref py py-obj docutils literal notranslate"><span class="pre">fbands</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray (nbands,)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>From ut_fbndavg, which was based on residual_spectrum.m of
t_tide, Pawlowicz et al. (2002).</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">periodogram</a><ul>
<li><a class="reference internal" href="#module-utide.periodogram"><code class="xref py py-mod docutils literal notranslate"><span class="pre">utide.periodogram</span></code></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Internal details</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="robustfit.html"
                        title="next chapter">robustfit</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/internals/periodogram.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="robustfit.html" title="robustfit"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Internal details"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">UTide 0.2.6.dev10+g93cdb9e documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Internal details</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Dan Codiga, Wesley Bowman, and contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.1.
    </div>
  </body>
</html>